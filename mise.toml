[env]
_.python.venv = { path = ".venv", create = true }

[hooks]
postinstall = [
    "mise run set_up_git_hooks",
    "pip install -r .config/requirements.txt --require-virtualenv -q"
]

[settings]
experimental = true # Needed for hooks as of 2025/05/31

[tasks.set_up_git_hooks]
run = '''
#!/usr/bin/env python

import os
import subprocess

github_actions = os.environ.get("GITHUB_ACTIONS")
azure_pipelines = os.environ.get("TF_BUILD")

if github_actions or azure_pipelines:
    echo("Not setting up git hooks as mise is running in CI!")
else:
    sp = subprocess.run(["hk", "install", "--mise"], capture_output=True)
    echo(sp.stdout)
'''

[tools]
# Project Tools
hk = "1.1.2"
python = "3.13.3"
# Backends
#java = "temurin-jre-24.0.1+9" # Used by pkl VSCode plugin; can be removed when this is resolved: https://github.com/apple/pkl-lsp/issues/60
node = "22.16.0" # Used by cspell, markdownlint, markdown-link-check, prettier
pkl = "0.28.2" # Used by hk
# Linters
actionlint = "1.7.7"
#markdownlint-cli2 = "0.18.1"
#"npm:@commitlint/cli" = "19.8.1"
"npm:cspell" = "9.0.2"
"npm:markdown-link-check" = "3.13.7"
"npm:prettier" = "3.5.3"
# "pipx:yamlfix" = "1.16.1"
# "pipx:yamllint" = "1.37.1"
#ruff = "0.11.12"
shellcheck = "0.10.0"
taplo = "0.10.0"
